# Rate Limiting Configuration
# Copy this file to .env and customize the values

# General Rate Limiting
RATE_LIMIT_WINDOW_MS=900000          # 15 minutes in milliseconds
RATE_LIMIT_MAX_REQUESTS=100          # Max requests per window

# Authentication Rate Limiting
AUTH_RATE_LIMIT_WINDOW_MS=900000     # 15 minutes
AUTH_RATE_LIMIT_MAX_ATTEMPTS=5       # Max auth attempts per window

# API Rate Limiting
API_RATE_LIMIT_WINDOW_MS=900000      # 15 minutes
API_RATE_LIMIT_MAX_REQUESTS=50       # Max API requests per window

# File Upload Rate Limiting
UPLOAD_RATE_LIMIT_WINDOW_MS=3600000  # 1 hour
UPLOAD_RATE_LIMIT_MAX_FILES=10       # Max file uploads per hour

# MFA Rate Limiting
MFA_RATE_LIMIT_WINDOW_MS=300000      # 5 minutes
MFA_RATE_LIMIT_MAX_ATTEMPTS=3        # Max MFA attempts per 5 minutes

# Admin Operations Rate Limiting
ADMIN_RATE_LIMIT_WINDOW_MS=900000    # 15 minutes
ADMIN_RATE_LIMIT_MAX_OPERATIONS=30   # Max admin operations per window

# Speed Limiting
SPEED_LIMIT_WINDOW_MS=900000         # 15 minutes
SPEED_LIMIT_DELAY_AFTER=50           # Start delaying after 50 requests
SPEED_LIMIT_DELAY_MS=500             # 500ms delay per request
SPEED_LIMIT_MAX_DELAY_MS=20000       # Maximum 20 second delay

# Role-based Rate Limiting
ROLE_ADMIN_RATE_LIMIT=100            # Admin users: 100 requests per window
ROLE_TENANT_ADMIN_RATE_LIMIT=50      # Tenant admins: 50 requests per window
ROLE_USER_RATE_LIMIT=25              # Regular users: 25 requests per window
ROLE_DEFAULT_RATE_LIMIT=10           # Default: 10 requests per window

# Trust Proxy Settings
TRUST_PROXY=false                     # Set to true if behind a reverse proxy

# Skip Rate Limiting for Specific IPs (comma-separated)
SKIP_RATE_LIMIT_IPS=127.0.0.1,::1

# Skip Rate Limiting for Specific User Agents (comma-separated)
SKIP_RATE_LIMIT_USER_AGENTS=health-check,monitoring-bot

# Environment-specific overrides are automatically applied based on NODE_ENV
# Development: More lenient limits
# Staging: Moderate limits  
# Production: Stricter limits 